{% extends 'fronted/fronted.html.twig' %}

{% block metadata %}
    <meta name="title" content="{{ property.street.zone.name }} - {{ property.street.name }} - {{ property.commercial.agency.name }}">
    <meta name="description" content="{{ property.typeProperty.name }} de {{ property.rateHousing.realMeters }}m² en {{ property.street.zone.name }} - {{ property.street.name }}">

    <meta property="og:type" content="website">
    <meta property="og:url" content="{{ app.request.schemeAndHttpHost ~ app.request.requestUri }}">
    <meta property="og:title" content="{{ property.typeProperty.name }} de {{ property.rateHousing.realMeters }}m² en {{ property.street.zone.name }} - {{ property.street.name }}">
    <meta property="og:description" content="{{ property.street.zone.name }} - {{ property.street.name }}">
    {% if property.rateHousing.image.first  %}
        <meta property="og:image" content="{{ uploaded_asset(property.rateHousing.image.first.imagePath)|imagine_filter('squared_thumbnail_small') }}">
    {% else %}
        <meta property="og:image" content="{{ asset('img/logo-erreka.png')|imagine_filter('squared_thumbnail_large') }}">
    {% endif %}

{% endblock %}

{% block title %}{{ property.street.zone.name }} - {{ property.street.name }}{% endblock %}

{% block body %}
    <!-- Page Content -->
    <div class="container mt-5">
        <div class="row">
            <!-- Post Content Column -->
            <div class="col-md-8">
                <!-- Title -->
                <h1 class="mt-4">
                    {% set sum = 0 %}
                    {% for reduction in property.propertyReductions %}
                        {% set sum = sum + reduction.price %}
                    {% endfor %}

                    {% if property.charge %}
                        {{ (property.charge.price - sum)|number_format(0, ',', '.') }} €
                    {% endif %}
                </h1>

                <!-- Author -->
                <p class="lead">
                    {{ property.street.zone.name }} - {{ property.street.name }}
                </p>

                <hr>

                <!-- Preview Image -->
                <div id="myCarousel" class="carousel slide" data-ride="carousel">
                    <div class="carousel-inner">
                        {% set isFirst = true %}
                        {% for image in property.rateHousing.image if image.rateHousing.id == property.rateHousing.id %}
                            {% if isFirst == true %}
                                <div class="carousel-item active">
                            {% else %}
                                <div class="carousel-item">
                            {% endif %}
                                    <img class="d-block img-fluid" src="{{ uploaded_asset(image.imagePath) }}" alt="{{ uploaded_asset(image.nameImage) }}">
                                </div>
                            {% set isFirst = false %}
                        {% endfor %}
                            {% if property.rateHousing.image.count != 1 %}
                                <a class="carousel-control-prev" href="#myCarousel" role="button" data-slide="prev">
                                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                    <span class="sr-only">Previous</span>
                                </a>
                                <a class="carousel-control-next" href="#myCarousel" role="button" data-slide="next">
                                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                    <span class="sr-only">Next</span>
                                </a>
                            {% endif %}
                    </div>
                </div>

                <hr>
                <!-- Post Content -->
                <p class="lead">{{ property.rateHousing.comment }}</p>
                <hr>
            </div>

            <!-- Sidebar Widgets Column -->
            <div class="col-md-4 mt-5">

                <div class="card border-info mt-5">
                    <h5 class="card-header bg-info text-white border-info">Contacta</h5>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            Agente
                            <span class="">{{ property.commercial.fullName }}</span>
                        </li>

                        {% set message = 'Hola, quería más información de está propiedad. ' %}


                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <span>WhatsApp</span>
                            <span class=""><a target="_blank" href="https://wa.me/{{ 34 ~ property.commercial.mobile }}?text={{ message }}{{ app.request.schemeAndHttpHost ~ app.request.requestUri }}"><i class="fab fa-whatsapp text-success"></i> {{ property.commercial.mobile }}</a></span>
                        </li>
                    </ul>
                </div>
                <!-- DISTRIBUCIÓN -->
                <div class="card border-info my-4">
                    <h5 class="card-header bg-info text-white border-info">Distribución</h5>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            Dormitorios
                            <span>{{ property.rateHousing.bedrooms }}</span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            Baños
                            <span>{{ property.rateHousing.bathrooms }}</span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            Metros
                            <span>{{ property.rateHousing.realMeters }}m<sup>2</sup></span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            C. Energético
                            <span>{{ property.rateHousing.energyCertificate ? property.rateHousing.energyCertificate.name }}</span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            Calefacción
                            <span>{{ property.rateHousing.heating ? property.rateHousing.heating.name }}</span>
                        </li>
                    </ul>
                </div>

                <!-- EXTRAS -->
                <div class="card border-info my-4">
                    <h5 class="card-header bg-info text-white border-info">Extras</h5>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            Cota Cero
                            <span>{{ property.rateHousing.zeroDimension ? 'Si' : 'No' }}</span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            Balcón
                            <span>{{ property.rateHousing.balcony ? 'Si' : 'No' }}</span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            Garaje Directo
                            <span>{{ property.rateHousing.directGarage ? 'Si' : 'No' }}</span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            Trastero
                            <span>{{ property.rateHousing.storageRoom ? 'Si' : 'No' }}</span>
                        </li>
                    </ul>
                </div>

                <!-- EDIFICIO -->
                <div class="card border-info my-4">
                    <h5 class="card-header bg-info text-white border-info">Edificio</h5>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            Ascensor
                            <span>{{ property.rateHousing.elevator ? 'Si' : 'No' }}</span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            Antigüedad
                            <span>{{ property.rateHousing.antiquity ? 'Si' : 'No' }}</span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            Estructura Edificio
                            <span>{{ property.rateHousing.buildingStructure ? property.rateHousing.buildingStructure.name }}</span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            Gastos Comunidad
                            <span>{{ property.rateHousing.communityExpenses|number_format(0, ',', '.') }}</span>
                        </li>
                    </ul>
                </div>
            </div>

        </div>
        <!-- /.row -->

    </div>
    <!-- /.container -->
{% endblock %}